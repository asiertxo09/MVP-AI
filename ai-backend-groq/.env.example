# Variables de entorno para EduPlay Backend

# Groq API Key (REQUERIDA)
# Obt√©n tu key gratis en: https://console.groq.com
GROQ_API_KEY=your_groq_api_key_here

# Puerto del servidor (opcional)
PORT=3000
# EduPlay - Backend Unificado

## üéØ Descripci√≥n

Backend unificado que proporciona todos los servicios de AI para EduPlay:
- **Transcripci√≥n de audio** usando Groq Whisper API
- **Text-to-Speech** usando gTTS
- **Chat/Completions** usando Groq LLM API

## üöÄ Caracter√≠sticas

- ‚úÖ **Sin dependencias pesadas**: No requiere PyTorch, Transformers ni modelos locales
- ‚úÖ **Escalable**: Usa APIs externas (Groq) que escalan autom√°ticamente
- ‚úÖ **R√°pido**: Groq Whisper es extremadamente r√°pido (~1-2 segundos)
- ‚úÖ **Gratis**: Groq ofrece tier gratuito muy generoso
- ‚úÖ **Bajo uso de memoria**: ~50MB vs 500MB+ del servicio anterior
- ‚úÖ **CORS configurado**: Listo para producci√≥n

## üì¶ Instalaci√≥n

### Desarrollo Local

```bash
cd ai-backend-groq
pip install -r requirements.txt
```

### Variables de Entorno

Crea un archivo `.env`:

```env
GROQ_API_KEY=tu_api_key_aqui
PORT=3000
```

Para obtener tu API key de Groq:
1. Visita https://console.groq.com
2. Crea una cuenta (gratis)
3. Ve a "API Keys" y genera una nueva key

### Ejecutar

```bash
python app.py
```

El servidor estar√° disponible en `http://localhost:3000`

## üîå Endpoints

### Health Check
```
GET /health
```

Respuesta:
```json
{
  "ok": true,
  "service": "eduplay-backend",
  "version": "1.0.0",
  "groq_configured": true,
  "endpoints": {
    "transcribe": "/transcribe",
    "tts": "/tts",
    "chat": "/chat"
  }
}
```

### Transcripci√≥n de Audio
```
POST /transcribe
Content-Type: application/json

{
  "audio": "base64_encoded_audio",
  "format": "wav",
  "language": "es"
}
```

Respuesta:
```json
{
  "text": "texto transcrito",
  "confidence": 0.95,
  "language": "es",
  "model": "whisper-large-v3"
}
```

### Text-to-Speech
```
POST /tts
Content-Type: application/json

{
  "text": "Hola, ¬øc√≥mo est√°s?",
  "language": "es",
  "speed": 1.0
}
```

Respuesta: Audio MP3 binario

### Chat Completion
```
POST /chat
Content-Type: application/json

{
  "messages": [
    {"role": "user", "content": "Hola"}
  ],
  "model": "llama-3.3-70b-versatile",
  "temperature": 0.7,
  "max_tokens": 1024
}
```

Respuesta: Formato est√°ndar de OpenAI chat completion

## üåê Despliegue en Render

El archivo `render.yaml` en la ra√≠z del proyecto est√° configurado para desplegar autom√°ticamente.

### Pasos:

1. **Conecta tu repositorio a Render**
2. **Configura la variable de entorno** `GROQ_API_KEY` en el dashboard de Render
3. **Despliega** - Se desplegar√° autom√°ticamente con el `render.yaml`

El servicio estar√° disponible en: `https://eduplay-backend.onrender.com`

## üîß Configuraci√≥n del Frontend

El frontend ya est√° configurado para usar este backend unificado en `frontend/scripts/config.js`:

```javascript
window.ENV = {
  BACKEND_URL: 'https://eduplay-backend.onrender.com',
  AUDIO_SERVICE_URL: 'https://eduplay-backend.onrender.com'
}
```

## üìä Ventajas vs Servicio Anterior

| Aspecto | Anterior (Whisper local) | Nuevo (Groq API) |
|---------|-------------------------|------------------|
| **Memoria** | ~500MB | ~50MB |
| **Velocidad** | 30-60s primera vez | 1-2s siempre |
| **Escalabilidad** | Limitada por RAM | Ilimitada |
| **Costo** | Plan Starter ($7/mes) | Plan Free |
| **Mantenimiento** | Modelos, dependencias | Ninguno |
| **Confiabilidad** | Puede crashear | Alta disponibilidad |

## üêõ Troubleshooting

### Error: "Groq API key no configurada"
- Verifica que `GROQ_API_KEY` est√© en `.env` (local) o en las variables de entorno de Render

### Error 429: Rate limit
- Groq tiene l√≠mites en el tier gratuito
- Considera implementar rate limiting en el frontend
- O actualizar a plan de pago de Groq

### Audio no se transcribe
- Verifica que el audio est√© en formato WAV, 16kHz
- Verifica que el base64 est√© correctamente codificado
- Revisa los logs para ver el error espec√≠fico

## üìù Notas

- **Groq Whisper** soporta m√∫ltiples idiomas autom√°ticamente
- **gTTS** requiere conexi√≥n a internet (usa Google TTS)
- El servidor usa **FastAPI** con soporte async para mejor performance

