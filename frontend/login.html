<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Iniciar sesión · EduPlay</title>
    <style>
        body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#0f172a;color:#e2e8f0}
        .wrap{max-width:420px;margin:10vh auto;padding:24px}
        form{display:grid;gap:12px;background:#111827;border:1px solid #1f2937;border-radius:16px;padding:20px}
        input{padding:10px;border-radius:10px;border:1px solid #374151;background:#0b1220;color:#e5e7eb}
        button{padding:12px;border-radius:10px;border:0;background:#2563eb;color:#fff;cursor:pointer}
        .err{color:#fca5a5}
    </style>
</head>
<body>
<div class="wrap">
    <h2>Acceder</h2>
    <form id="f">
        <input name="username" placeholder="Usuario" required />
        <input name="password" placeholder="Contraseña" type="password" required />
        <button>Entrar</button>
        <div class="err" id="e"></div>
    </form>
</div>
<script>
    const f = document.getElementById('f'), e = document.getElementById('e');
    f.addEventListener('submit', async (ev) => {
        ev.preventDefault();
        e.textContent = '';
        const fd = new FormData(f);
        const body = { username: fd.get('username'), password: fd.get('password') };
        const res = await fetch('/api/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body),
            credentials: 'include'
        });
        if (res.ok) location.href = '/app/';
        else e.textContent = (await res.text()) || 'Usuario o contraseña incorrectos';
    });
</script>
</body>
</html>
